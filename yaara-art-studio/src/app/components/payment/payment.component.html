<!-- Payment Component -->
<div class="payment-section">
  <div class="container">
    <div class="payment-content">
      <div class="payment-header">
        <h2>תשלום עבור שיעור ניסיון</h2>
        <p class="payment-description">שיעור ניסיון ב-<span class="price">50₪</span> בלבד</p>
        <p class="payment-subtitle">בחרו את דרך התשלום המועדפת עליכם</p>
      </div>
      
      <!-- Recommended Payment Methods (No Fees) -->
      <div class="payment-section-group">
        <div class="section-header">
          <h3>🏆 מומלץ (ללא עמלות)</h3>
          <p>דרכי התשלום הפופולריות בישראל</p>
        </div>
        
        <div class="payment-methods">
          <!-- Bit Payment -->
          <div class="payment-method bit-method" (click)="initiateBitPayment()">
            <div class="method-icon bit">
              <img src="assets/images/Bit_logo.svg.png" alt="Bit" class="payment-logo">
            </div>
            <div class="method-content">
              <h3>Bit</h3>
              <p>{{ getPaymentMethodInfo('bit').description }}</p>
              <span class="method-price">50₪</span>
              <span class="fee-info">ללא עמלות</span>
            </div>
            <div class="method-arrow">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
              </svg>
            </div>
          </div>

          <!-- PayBox Payment -->
          <div class="payment-method paybox-method" (click)="initiatePayBoxPayment()">
            <div class="method-icon paybox">
              <img src="assets/images/paybox.png" alt="PayBox" class="payment-logo">
            </div>
            <div class="method-content">
              <h3>PayBox</h3>
              <p>{{ getPaymentMethodInfo('paybox').description }}</p>
              <span class="method-price">50₪</span>
              <span class="fee-info">ללא עמלות</span>
            </div>
            <div class="method-arrow">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
              </svg>
            </div>
          </div>

          <!-- Kashkash Payment -->
          <div class="payment-method kashkash-method" (click)="initiateKashkashPayment()">
            <div class="method-icon kashkash">
              <img src="assets/images/kashkashlogo.png" alt="Kashkash" class="payment-logo">
            </div>
            <div class="method-content">
              <h3>Kashkash</h3>
              <p>{{ getPaymentMethodInfo('kashkash').description }}</p>
              <span class="method-price">50₪</span>
              <span class="fee-info">ללא עמלות</span>
            </div>
            <div class="method-arrow">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
              </svg>
            </div>
          </div>
        </div>
      </div>

      <!-- International Payment Methods -->
      <div class="payment-section-group">
        <div class="section-header">
          <h3>🌍 כרטיסי אשראי</h3>
          <p>לתשלומים בינלאומיים ולקוחות מחו"ל</p>
        </div>
        
        <div class="payment-methods">
          <!-- Apple Pay -->
          <div class="payment-method apple-pay-method" 
               *ngIf="isApplePayAvailable" 
               (click)="processApplePayPayment()">
            <div class="method-icon apple-pay">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
              </svg>
            </div>
            <div class="method-content">
              <h3>Apple Pay</h3>
              <p>{{ getPaymentMethodInfo('applePay').description }}</p>
              <span class="method-price">50₪</span>
              <span class="fee-info">עמלה: 2.9%</span>
            </div>
            <div class="method-arrow">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
              </svg>
            </div>
          </div>

          <!-- Credit Card -->
          <div class="payment-method credit-card-method" (click)="showCreditCardPayment()">
            <div class="method-icon credit-card">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/>
              </svg>
            </div>
            <div class="method-content">
              <h3>{{ getPaymentMethodInfo('creditCard').name }}</h3>
              <p>{{ getPaymentMethodInfo('creditCard').description }}</p>
              <span class="method-price">50₪</span>
              <span class="fee-info">עמלה: 2.9%</span>
            </div>
            <div class="method-arrow">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
              </svg>
            </div>
          </div>
        </div>
      </div>

      <!-- Credit Card Form -->
      <div class="credit-card-form" *ngIf="showCreditCardForm">
        <div class="form-header">
          <h3>💳 תשלום בכרטיס אשראי</h3>
          <button class="close-btn" (click)="hideCreditCardForm()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
            </svg>
          </button>
        </div>

        <form (ngSubmit)="processCreditCardPayment()" #creditCardForm="ngForm">
          <div class="form-group">
            <label for="cardholderName">שם בעל הכרטיס *</label>
            <input 
              type="text" 
              id="cardholderName" 
              name="cardholderName" 
              [(ngModel)]="cardholderName" 
              required 
              placeholder="הכנס שם מלא"
              class="form-input">
          </div>

          <div class="form-group">
            <label for="email">כתובת אימייל *</label>
            <input 
              type="email" 
              id="email" 
              name="email" 
              [(ngModel)]="email" 
              required 
              placeholder="example@gmail.com"
              class="form-input">
          </div>

          <div class="form-group">
            <label for="phone">מספר טלפון</label>
            <input 
              type="tel" 
              id="phone" 
              name="phone" 
              [(ngModel)]="phone" 
              placeholder="055-664-6033"
              class="form-input">
          </div>

          <div class="form-group">
            <label for="cardElement">פרטי הכרטיס *</label>
            <div class="card-element-container">
              <div #cardElement class="card-element"></div>
            </div>
          </div>

          <div class="payment-error" *ngIf="paymentError">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
            </svg>
            {{ paymentError }}
          </div>

          <div class="form-actions">
            <button 
              type="button" 
              class="btn btn-secondary" 
              (click)="hideCreditCardForm()"
              [disabled]="isLoading">
              ביטול
            </button>
            <button 
              type="submit" 
              class="btn btn-primary" 
              [disabled]="!creditCardForm.form.valid || isLoading">
              <span *ngIf="!isLoading">שלם 50₪</span>
              <span *ngIf="isLoading">מעבד תשלום...</span>
            </button>
          </div>
        </form>
      </div>

      <!-- Apple Pay Button Container -->
      <div class="apple-pay-container" *ngIf="isApplePayAvailable && !showCreditCardForm">
        <div class="apple-pay-header">
          <h3>🍎 תשלום עם Apple Pay</h3>
          <p>תשלום מהיר ובטוח עם Touch ID או Face ID</p>
        </div>
        <div #applePayButton class="apple-pay-button"></div>
      </div>

      <!-- Contact Information -->
      <div class="payment-contact">
        <h4>פרטי התקשרות</h4>
        <div class="contact-info">
          <div class="contact-item">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
            </svg>
            <span>055-664-6033</span>
            <button class="copy-btn" (click)="copyPhoneNumber(); $event.stopPropagation()" title="העתק מספר טלפון">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
              </svg>
            </button>
          </div>
          <div class="contact-item">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
            </svg>
            <span>yaarabuda1&#64;gmail.com</span>
          </div>
        </div>
      </div>

      <!-- Payment Instructions -->
      <div class="payment-instructions">
        <h4>הוראות תשלום</h4>
        <ul>
          <li>לחצו על אחת מדרכי התשלום למעלה</li>
          <li>אם יש לכם את האפליקציה - היא תיפתח אוטומטית</li>
          <li>אם אין לכם את האפליקציה - תועברו לגרסת האינטרנט</li>
          <li>לאחר התשלום, לחצו על "סיימתי לשלם" למטה</li>
        </ul>
        
        <div class="payment-complete-section">
          <button class="btn btn-primary payment-complete-btn" (click)="onPaymentSuccess()">
            סיימתי לשלם
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Success Message Popup -->
<div class="success-message" *ngIf="showSuccessMessage">
  <div class="success-content">
    <div class="success-icon">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
      </svg>
    </div>
    <h3>תודה על התשלום!</h3>
    <p>התשלום התקבל בהצלחה 🌸</p>
    <p class="success-details">
      נחזור אליך בהקדם לאישור השיעור.
      <br>
      תוך 24 שעות תקבל הודעה עם פרטי השיעור.
    </p>
  </div>
</div>